# Veil — coturn TURN/STUN Configuration
# See MODULE_01_BACKEND.md §3.3

# Network
listening-port=3478
tls-listening-port=5349
listening-ip=0.0.0.0
listening-ip=::

# TLS certificates
cert=/etc/coturn/certs/server.pem
pkey=/etc/coturn/certs/key.pem

# Authentication — TURN REST API with shared secret (time-limited credentials)
use-auth-secret
static-auth-secret=__TURN_SECRET__

# External IP (public-facing address for relay candidates)
external-ip=__SERVER_IP__

# Realm
realm=__XMPP_DOMAIN__

# Logging
log-file=/var/log/coturn/turnserver.log
verbose

# Security hardening
no-multicast-peers
no-cli
fingerprint
lt-cred-mech

# Disable old TLS versions
no-tlsv1
no-tlsv1_1

# Relay address range (restrict to avoid open-relay abuse)
min-port=49152
max-port=65535

# Rate limiting
total-quota=100
bps-capacity=0
stale-nonce=600

# Deny loopback and private ranges for relay (prevent SSRF)
denied-peer-ip=0.0.0.0-0.255.255.255
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=100.64.0.0-100.127.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=169.254.0.0-169.254.255.255
denied-peer-ip=172.16.0.0-172.31.255.255
denied-peer-ip=192.0.0.0-192.0.0.255
denied-peer-ip=192.88.99.0-192.88.99.255
denied-peer-ip=240.0.0.0-255.255.255.255
